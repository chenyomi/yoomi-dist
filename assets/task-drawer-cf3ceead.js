import{s as P,c as B}from"./createBoard-57eb3d80.js";import{u as X}from"./index-c00940a8.js";import{i as v,a as _,b as g,d as F,e as b,h as e,q as h,P as k,B as Y,J as Z,o as G,n as M,K as W,w as R,A as j,ay as z,p as A,j as $,f as n}from"./index-db10600d.js";import{g as q}from"./utils-79b8b97a.js";import{_ as I}from"./_plugin-vue_export-helper-c27b6911.js";import{V as N}from"./VSelect-4ee12ab2.js";import{V as p}from"./VTextField-078820a9.js";import{V as E}from"./VCard-1b3936c5.js";import"./request-8e1b1635.js";import"./OrbitControls-6e5a6999.js";import"./VInput-77accd7e.js";import"./VImg-663304c0.js";import"./VMenu-82aac33c.js";import"./VAvatar-039e85c6.js";import"./VDivider-5b514e0a.js";import"./VOverlay-559319d5.js";import"./VCheckboxBtn-0f686395.js";const J={class:"px-5 pt-7 pb-5"},K={__name:"task-drawer-form",setup(c,{expose:V}){const i=v("density"),t=_({materialTemplateShape:0,materialTemplateLengthX:null,materialTemplateLengthY:null,materialTemplateLengthZ:null,materialNumber:null,materialName:""}),x=q("sss_material_template_shape"),s=()=>{};return V({submit:()=>new Promise(o=>{o(t.value)})}),(o,a)=>(g(),F("div",J,[b(N,{modelValue:e(t).materialTemplateShape,"onUpdate:modelValue":[a[0]||(a[0]=l=>e(t).materialTemplateShape=l),s],items:e(x),density:e(i),class:"mb-2",label:"物料形状"},null,8,["modelValue","items","density"]),b(p,{modelValue:e(t).materialName,"onUpdate:modelValue":a[1]||(a[1]=l=>e(t).materialName=l),label:"物料名称：",density:e(i),class:"mb-2"},null,8,["modelValue","density"]),e(t).materialTemplateShape===0?(g(),h(p,{key:0,modelValue:e(t).materialTemplateLengthX,"onUpdate:modelValue":[a[2]||(a[2]=l=>e(t).materialTemplateLengthX=l),s],label:"X轴长度：",density:e(i),class:"mb-2",suffix:"mm",type:"number"},null,8,["modelValue","density"])):k("",!0),e(t).materialTemplateShape===0?(g(),h(p,{key:1,modelValue:e(t).materialTemplateLengthY,"onUpdate:modelValue":[a[3]||(a[3]=l=>e(t).materialTemplateLengthY=l),s],label:"Y轴长度：",density:e(i),class:"mb-2",suffix:"mm",type:"number"},null,8,["modelValue","density"])):k("",!0),e(t).materialTemplateShape===1?(g(),h(p,{key:2,modelValue:e(t).materialTemplateLengthX,"onUpdate:modelValue":[a[4]||(a[4]=l=>e(t).materialTemplateLengthX=l),s],label:"半径：",density:e(i),class:"mb-2",suffix:"mm",type:"number"},null,8,["modelValue","density"])):k("",!0),b(p,{modelValue:e(t).materialTemplateLengthZ,"onUpdate:modelValue":[a[5]||(a[5]=l=>e(t).materialTemplateLengthZ=l),s],label:"Z轴长度：",density:e(i),suffix:"mm",class:"mb-2",type:"number"},null,8,["modelValue","density"]),b(p,{modelValue:e(t).materialNumber,"onUpdate:modelValue":a[6]||(a[6]=l=>e(t).materialNumber=l),label:"数量",density:e(i),class:"mb-2",type:"number"},null,8,["modelValue","density"])]))}},H=I(K,[["__scopeId","data-v-ac9aa607"]]);const D=c=>(A("data-v-ea0d666a"),c=c(),$(),c),O=D(()=>n("div",{class:"pix"},[n("div",null,[n("span",{style:{background:"#ffa726"}}),n("span",null,"X")]),n("div",null,[n("span",{style:{background:"#039be5"}}),n("span",null,"Y")]),n("div",null,[n("span",{style:{background:"#b2ff59"}}),n("span",null,"Z")])],-1)),Q=D(()=>n("div",{id:"box",class:"h-100"},null,-1)),ee={__name:"task-drawer",setup(c){const{t:V}=Y(),i=Z(),t=v("density"),x=v("btnList"),s=v("next"),L=v("message"),o=_(),a=_(),l=X(),U=()=>{l.setProcess({storagePalletId:o.value}),a.value=f.value.filter(d=>d.value==o.value)[0],u.disWebGl(),u.updata({...a.value.storagePallet,materialList:[]})};let f=_([]),u=null;return G(()=>{M(()=>{x.value=[{name:"新增物料",color:"#7986CB",size:"large",width:150,formWidth:400,hideDiaName:!0,slot:j(H),slotData:{},fn:({close:r,openLoading:m,closeLoading:y,diaFormRef:w})=>{m({text:"正在上传更新"}),w.submit().then(T=>{T.storagePalletId=o.value,P.getStorageMaterial(T).then(S=>{a.value.storagePallet=S.data,u.disWebGl(),u.updata(a.value.storagePallet)})}).finally(()=>{r(),y()})}},{name:s.value.name,color:"#D32F2F",size:"large",width:220,mark:s.value.intro,fn:({close:r,openLoading:m,closeLoading:y})=>{m({text:s.value.loadtext}),r(),setTimeout(()=>{y(),s.value.type=="next"?i.push({path:s.value.nextPath}):s.value.type=="last"&&i.push({path:"/tasklist"})},1e3)},before:({dialog:r,openLoading:m,close:y,dialogLoading:w,closeLoading:T,dialogLoadingText:S})=>{a.value.storagePallet.materialList&&a.value.storagePallet.materialList.length?P.getStorageMaterialCheck({materialList:a.value.storagePallet.materialList}).then(C=>{r.value=!0}).catch(C=>{L.value.open({text:"必须选择同一种物料"})}):L.value.open({text:"请选择物料"})}}];const{process:d}=z(l);P.getStorage().then(r=>{f.value=r.data,o.value=d.value.storagePalletId?d.value.storagePalletId:r.data[0].value,l.setProcess({storagePalletId:o.value}),a.value=f.value.filter(m=>m.value==o.value)[0],a.value.storagePallet.materialList=d.value.materialList||[],u=new B(a.value.storagePallet),u.onModalChange=m=>{a.value.storagePallet.materialList=m,l.setProcess({materialList:m})}})})}),W(()=>{u.disWebGl()}),(d,r)=>(g(),h(E,{id:"card-box",class:"h-100",style:{flex:"1"}},{default:R(()=>[b(N,{modelValue:o.value,"onUpdate:modelValue":[r[0]||(r[0]=m=>o.value=m),U],class:"w-25",style:{position:"absolute",top:"1rem",left:"0.75rem"},items:e(f),density:e(t),label:e(V)("料盘"),"item-title":"label","item-value":"value"},null,8,["modelValue","items","density","label"]),O,Q]),_:1}))}},ye=I(ee,[["__scopeId","data-v-ea0d666a"]]);export{ye as default};
