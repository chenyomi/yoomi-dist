import{t as ee}from"./task-2ac5eff5.js";import{V as te}from"./VMenu-c044b62a.js";import{m as ae,a as oe,b as se,c as le,d as re,e as ne,f as ie,u as de,p as ue,g as ce,h as me,i as pe,j as ge,k as ve,l as be,V as C,n as A,o as H,q as U}from"./VDataTable-688bfef0.js";import{s as he,z as ye,c as w,T as i,U as fe,W as Pe,D as Te,e as n,R as Se,X as V,i as q,a as d,B as xe,o as De,n as ke,b as we,q as Ve,w as I,G as Ie,t as Be,h as b,L as _e}from"./index-33a3edc6.js";import"./request-906bf077.js";import"./index-65a6e8b1.js";import"./VInput-b14eee4a.js";import"./VImg-377ae230.js";import"./VAvatar-42af6748.js";import"./VDivider-41704ff6.js";import"./VOverlay-79039b71.js";import"./VSelect-14a48aff.js";import"./VTextField-b50f4200.js";import"./VCheckboxBtn-5fc0691f.js";const Fe=he({itemsLength:{type:[Number,String],required:!0},...ae(),...oe(),...se()},"VDataTableServer"),Re=ye()({name:"VDataTableServer",props:Fe(),emits:{"update:modelValue":t=>!0,"update:page":t=>!0,"update:itemsPerPage":t=>!0,"update:sortBy":t=>!0,"update:options":t=>!0,"update:expanded":t=>!0,"update:groupBy":t=>!0},setup(t,f){let{attrs:P,slots:e}=f;const{groupBy:u}=le(t),{sortBy:o,multiSort:T,mustSort:S}=re(t),{page:c,itemsPerPage:m}=ne(t),y=w(()=>parseInt(t.itemsLength,10)),{columns:p,headers:x}=ie(t,{groupBy:u,showSelect:i(t,"showSelect"),showExpand:i(t,"showExpand")}),{items:s}=de(t,p),{toggleSort:l}=ue({sortBy:o,multiSort:T,mustSort:S,page:c}),{opened:r,isGroupOpen:g,toggleGroup:v,extractRows:B}=ce({groupBy:u,sortBy:o}),{pageCount:D,setItemsPerPage:z}=me({page:c,itemsPerPage:m,itemsLength:y}),{flatItems:_}=pe(s,u,r),{isSelected:O,select:j,selectAll:W,toggleSelect:M,someSelected:X,allSelected:J}=ge(t,{allItems:s,currentPage:s}),{isExpanded:K,toggleExpand:Q}=ve(t),F=w(()=>B(s.value));be({page:c,itemsPerPage:m,sortBy:o,groupBy:u,search:i(t,"search")}),fe("v-data-table",{toggleSort:l,sortBy:o}),Pe({VDataTableRows:{hideNoData:i(t,"hideNoData"),noDataText:i(t,"noDataText"),loading:i(t,"loading"),loadingText:i(t,"loadingText")}});const a=w(()=>({page:c.value,itemsPerPage:m.value,sortBy:o.value,pageCount:D.value,toggleSort:l,setItemsPerPage:z,someSelected:X.value,allSelected:J.value,isSelected:O,select:j,selectAll:W,toggleSelect:M,isExpanded:K,toggleExpand:Q,isGroupOpen:g,toggleGroup:v,items:F.value.map(k=>k.raw),internalItems:F.value,groupedItems:_.value,columns:p.value,headers:x.value}));Te(()=>{const k=C.filterProps(t),Y=A.filterProps(t),Z=H.filterProps(t),$=U.filterProps(t);return n(U,V({class:["v-data-table",{"v-data-table--loading":t.loading},t.class],style:t.style},$),{top:()=>{var h;return(h=e.top)==null?void 0:h.call(e,a.value)},default:()=>{var h,R,L,N,E,G;return e.default?e.default(a.value):n(Se,null,[(h=e.colgroup)==null?void 0:h.call(e,a.value),n("thead",{class:"v-data-table__thead",role:"rowgroup"},[n(A,V(Y,{sticky:t.fixedHeader}),e)]),(R=e.thead)==null?void 0:R.call(e,a.value),n("tbody",{class:"v-data-table__tbody",role:"rowgroup"},[(L=e["body.prepend"])==null?void 0:L.call(e,a.value),e.body?e.body(a.value):n(H,V(P,Z,{items:_.value}),e),(N=e["body.append"])==null?void 0:N.call(e,a.value)]),(E=e.tbody)==null?void 0:E.call(e,a.value),(G=e.tfoot)==null?void 0:G.call(e,a.value)])},bottom:()=>e.bottom?e.bottom(a.value):n(C,k,{prepend:e["footer.prepend"]})})})}}),Xe={__name:"worklog",setup(t){const f=q("density"),P=d(),{t:e}=xe(),u={STOP:"#EF5350",RUN:"#689F38",STEPS:"#FFA726"},o=d(30);d({pageNum:1,pageSize:30});const T={async fetch({page:s,itemsPerPage:l,sortBy:r}){return new Promise(g=>{ee.taskLog({pageNum:s,pageSize:l}).then(v=>{const D=v.data.list;g({items:D,total:v.data.total})})})}},S=q("btnList");De(()=>{ke(()=>{S.value=[]})});const c=d([{title:e("状态"),align:"center",sortable:!1,key:"logType",width:100},{title:e("内容"),align:"start",sortable:!1,key:"logInfo"},{title:e("类型"),align:"center",sortable:!1,key:"taskType",width:100},{title:e("时间"),align:"end",sortable:!1,key:"createTime",width:200}]),m=d([]),y=d(0),p=d(!0);function x({page:s,itemsPerPage:l,sortBy:r}){p.value=!0,T.fetch({page:s,itemsPerPage:l,sortBy:r}).then(({items:g,total:v})=>{m.value=g,y.value=v,p.value=!1,P.value=g[0].id})}return(s,l)=>(we(),Ve(Re,{"items-per-page":b(o),"onUpdate:itemsPerPage":l[0]||(l[0]=r=>_e(o)?o.value=r:null),"fixed-header":"",headers:b(c),items:b(m),"items-length":b(y),loading:b(p),"loading-text":"",hover:"",height:"calc(100vh - 245px)",density:b(f),"onUpdate:options":x},{"item.logType":I(({item:r})=>[n(te,{label:"",color:u[r.logType]},{default:I(()=>[Ie(Be(r.logType),1)]),_:2},1032,["color"])]),loading:I(()=>[]),_:1},8,["items-per-page","headers","items","items-length","loading","density"]))}};export{Xe as default};
